// ===============================================================
// SISTEMA COMPLETO AGENTE DA NOITE
// ===============================================================

// VERIFICA√á√ÉO DE LOGIN EM TODAS AS P√ÅGINAS
function verificarLogin() {
    const usuario = JSON.parse(localStorage.getItem('usuarioLogado'));
    const paginaAtual = window.location.pathname;
    
    // P√°ginas que n√£o precisam de login
    const paginasPublicas = ['/index.html', '/login.html', '/cadastro.html', '/'];
    
    // Se n√£o est√° logado e tentando acessar p√°gina protegida
    if (!usuario && !paginasPublicas.some(pagina => paginaAtual.includes(pagina))) {
        window.location.href = 'login.html';
        return;
    }
    
    // Se est√° logado, atualiza a interface
    if (usuario) {
        atualizarInterfaceUsuario(usuario);
    }
}

// ATUALIZA A INTERFACE CONFORME O USU√ÅRIO LOGADO
function atualizarInterfaceUsuario(usuario) {
    const mainNav = document.querySelector('.main-nav');
    
    if (mainNav) {
        // Remove link de Login se existir
        const loginLink = mainNav.querySelector('a[href="login.html"]');
        if (loginLink) {
            loginLink.remove();
            
            // Adiciona bot√£o de sair
            const sairBtn = document.createElement('a');
            sairBtn.href = '#';
            sairBtn.className = 'nav-link neon-btn';
            sairBtn.textContent = `Sair (${usuario.nick})`;
            sairBtn.onclick = sair;
            mainNav.appendChild(sairBtn);
        }
    }
}

// FUN√á√ÉO PARA SAIR
function sair() {
    if (confirm('Tem certeza que deseja sair?')) {
        localStorage.removeItem('usuarioLogado');
        window.location.href = 'index.html';
    }
}

// INICIALIZA√á√ÉO DO SISTEMA
document.addEventListener('DOMContentLoaded', function() {
    console.log('üéÆ Agente Da Noite - Sistema Iniciado!');
    verificarLogin();
});

// SISTEMA DE PONTUA√á√ÉO PARA CAMPEONATO
function calcularPontuacao() {
    const linhas = document.querySelectorAll('.linha-tabela');
    linhas.forEach(linha => {
        // Sistema de c√°lculo de pontos pode ser adicionado aqui
        console.log('Calculando pontos para:', linha);
    });
}

// VERIFICA SE AS P√ÅGINAS EXISTEM (para debug)
function verificarPaginas() {
    const paginas = [
        'index.html', 'login.html', 'cadastro.html', 
        'campeonato.html', 'fron.html', 'regras.html',
        'area-visitante.html', 'membros.html'
    ];
    
    console.log('üîç Verificando p√°ginas...');
    
    paginas.forEach(pagina => {
        fetch(pagina)
            .then(response => {
                if (response.ok) {
                    console.log(`‚úÖ ${pagina} - OK`);
                } else {
                    console.log(`‚ùå ${pagina} - 404 N√£o encontrada`);
                }
            })
            .catch(error => {
                console.log(`‚ùå ${pagina} - Erro: ${error}`);
            });
    });
}

// EXECUTA VERIFICA√á√ÉO (descomente se quiser testar)
// verificarPaginas();